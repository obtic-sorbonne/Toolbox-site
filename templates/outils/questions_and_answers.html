{% extends "index.html" %}
{% block header %} {{ super() }} {% endblock %}

{% block content %}
<style>
    
  label, select {
  display: inline-block; /* Pour qu'ils puissent être sur la même ligne */
  vertical-align: middle; /* Aligne verticalement au centre si besoin */
  margin-bottom: 0; /* Supprime le margin-bottom sur le select */
}

label {
  margin-right: 10px; /* Un peu d'espacement entre le label et le select */
  font-weight: bold;
}

select {
  width: 20%; /* Ou une largeur fixe si tu veux */
  padding: 8px;
  box-sizing: border-box;
  border: 2px solid #263e8d;
  border-radius: 4px;
  background-color: #fff;
}
  textarea {
    width: 100%;
    padding: 8px;
    margin-bottom: 10px;
    box-sizing: border-box;
    border: 2px solid #263e8d;
    border-radius: 4px;
    background-color: #fff;
  }

</style>
<link rel="stylesheet" href="{{ url_for('static', filename= 'css/elements.css') }}">
<div class="outil">
    <div class="fil"><a href="{{ url_for('generation_texte')}}"><< {{ _('Retour aux tâches') }}</a></div>
    <h2>{{ _('Questions & Réponses') }}</h2>
    <p>
    {{ _("L'outil propose un mode d’interaction dédié aux questions-réponses, reposant sur un modèle d’intelligence artificielle avancé") }}. {{ _("Ce mode vous permet de poser une question précise en langage naturel et d’obtenir une réponse claire, fiable et directement pertinente. Grâce à une analyse fine du contexte que vous fournissez, le modèle identifie les éléments importants et vous restitue une réponse structurée, concise et compréhensible, sans que vous ayez à effectuer de recherche complémentaire") }}. {{ _("Ainsi, que vous ayez besoin d’éclaircissements sur un sujet particulier, d’une explication rapide ou d’informations factuelles, l’outil répond efficacement à votre demande, en quelques instants seulement") }}.</p>
    <br>
    <p style="text-align: center;padding:20px"><a href="{{ url_for('documentation_generation') }}"  target="_blank">{{ _('Voir la documentation') }}</a></p>
    <br>
    <div class="infos_outil" style="display: block;margin: 0 auto 15px auto;">
        <input id="show" type=checkbox><label for="show" class="infos_title" style="font-weight:normal;"><i class="fa-solid fa-circle-info"></i> {{ _("Informations sur l'outil") }}<i class="fa-solid fa-angle-right" style="float:right;margin-top:5px;margin-left:15px;cursor: pointer;"></i></label>
        <div class="info_popped">
          <p>Transformers
      <p>{{ _("Modèle ")}}:  <a href="https://huggingface.co/distilbert-base-cased-distilled-squad" target="_blank">distilbert-base-cased-distilled-squad</a></p>
      <p><i class="fa-solid fa-triangle-exclamation"></i> {{ _("Attention : Le modèle utilisé est assez lourd<br> donc le traitement peut être un peu long")}}.</p>
      </div>
  </div>
  <br>

    <form action="{{ url_for('qa_function') }}" method="post" enctype="multipart/form-data" onsubmit="showloader('loader')">
        <input type="hidden" name="tool_type" value="qa">

        <div class="form-group">
            <label style="margin-bottom: 10px;" for="context">{{ _('Contexte') }} :</label><br>
            <textarea name="context" id="context" rows="5" cols="50" required>{% if request.form.context %}{{ request.form.context }}{% else %}{{ _('Saisissez votre texte ici...') }}{% endif %}</textarea>
        </div>

        <div class="form-group">
            <label for="question">{{ _('Question') }} :</label>
            <input style="border: 2px solid #263e8d; width: 25%;" type="text" name="question" id="question" value="{% if request.form.question %}{{ request.form.question }}{% else %}{{ _('Saisissez votre question ici...') }}{% endif %}" required>
        </div>
        <br>

        <input id="csrf_token" name="csrf_token" type="hidden" value="{{ csrf_token() }}">

        <button type="submit" style="display:block;margin:auto;margin-top:20px;">{{ _('Obtenir une réponse') }}</button>
        <br>
    </form>

    {% if qa_result %}
    <div class="result-container">
        <h4>{{ _('Réponse ') }}:</h4>
        <div class="result-text">
            <p><strong>{{ _('Réponse trouvée') }}: </strong>{{ qa_result.answer }}</p>
            <p><strong>{{ _('Score') }}: </strong>{{ "%.2f"|format(qa_result.score) }}</p>
            <p><strong>{{ _('Début') }}: </strong>{{ qa_result.start }}</p>
            <p><strong>{{ _('Fin') }}: </strong>{{ qa_result.end }}</p>
        </div>
    </div>
    {% endif %}
    <br>

    {% if error %}
    <div class="error-message">
        <p>{{ error }}</p>
    </div>
    {% endif %}

    <div class="loader" id="loader" style="display: none;">
        <div class="loadingio-spinner-ball-205vl2x7n"><div class="ldio-b8p5li8dt1u"><div></div></div></div>
        <p>{{ _('Traitement en cours...') }}</p>
    </div>
</div>

<script>
    function showloader(id) {
        document.getElementById(id).style.display = 'block';
    }
</script>

{% endblock %}
{% block footer %} {{ super() }} {% endblock %}